---
title: Tell a Story
date: 2018-11-23 24:30:10
tags: 故事会
---
<font face="黑体">-------我------是-------分-------割-------线</font>
Once upon a time, there was a young monk in a temple on a mountain. What did the young monk tell the old monk about?
Once upon a time, there was a young monk in a temple on a mountain. What did the young monk tell the old monk about?
Once upon a time, there was a young monk in a temple on a mountain. What did the young monk tell the old monk about?
Once upon a time, there was a young monk in a temple on a mountain. What did the young monk tell the old monk about?
.
.

### Love & Peace
&emsp;&emsp;我是15年6月份毕业开始参加工作的，在2016年2月份正式开始接触学习使用Docker，当时公司主要是做Paas的，使用的是openshift的开源版，Docker用的1.9.1，最开始是懵逼的，都不是很明白，不明白openshift和kubernetes到底是什么关系，不明白container是干嘛的，不知道为什么在container之上又要封装一层pod，不知道什么是svc。。。从2013年Docker项目发布开始算起，这次变革也不过短短5年时间，可在现如今的技术圈儿里，不懂容器，没听过Kubernetes的人真的不多。
&emsp;&emsp;容器技术这样一个新生事物，完全重塑了整个云计算市场的形态，它不仅催生出了一批年轻有为的容器技术人(比如说XX&XXX)，更培育出了一个具有相当规模的开源基础设施技术市场。在这个市场里，不仅有Google、Microsoft、IBM、RedHat、Mesosphere等技术巨擘们厮杀至今，更有无数的国内外创业公司前仆后继。而在国内，甚至连以前对开源基础设施领域涉足不多的BAT、京东、蚂蚁、滴滴这样的巨头们也都从AI、云计算、大数据、微服务、基础设施等维度多管齐下，争相把容器和Kubernetes项目树立为战略重心之一。就在这场因“容器”而起的技术变革中，Kubernetes项目已经成为了容器技术的事实标准，重新定义了基础设施领域对应用编排与管理的种种可能。
&emsp;&emsp;刚开始搞Docker的时候大家或许都会懵逼，感觉跟之前所接触的开发运维测试生产环境有很大的区别，大概就是各种不适应，各种diss，觉得哪哪都没有一台虚拟机好，没有直接在操作系统中使用命令好。我们为什么要用docker？？技术的变革从来不是一个温和的过程，从过去以物理机虚拟机为基础设施主体的开发运维测试环境，向以容器为核心的基础设施为主体开发运维环境不断的演进中，其实我们可以类比于第一次工业革命向第二次工业革命转变的过程。这种变革涵盖了对网络、存储、调度、操作系统、分布式原理等各个方面的容器化理解与改造。
&emsp;&emsp;因为之前也做过openstack，在使用kubernetes时会不自觉的跟openstack做一下对比。接上文所说的工业革命，在我个人看来，第一次工业革命就好比是kvm xen等虚拟化产品的出现，第二次工业革命就好比Docker rkt等容器技术的出现。如果搞过openstack应该知道，openstack是管理VM的工具。相对来说kubernetes就是管理Container的工具。一句话，OpenStack面向资源层，改变的是资源供给模式，而Kubernetes面向应用层，变革的是业务架构。
&emsp;&emsp;个人的一些狭隘的理解。使用容器且集群规模不大时，直接用Kubenetes就可以；集群规模大，不管应用是否只是跑在容器中，都是OpenStack+Kubernetes更好，或者可以说Iaas+kubernetes更好。OpenStack+Kubernetes是各取所长，因为在某些方面Container还有些不足之处，比如Container的隔离性还需要加强，需要加一层 VM（虚拟机）来弥补，而OpenStack是很好的方案。不过，VM+Container的模式，必然有性能的损耗，这时我们就需要放弃一些性能上的需求。
&emsp;&emsp;不会变化的只有变化，未来的业务都会运行在云上，容器技术是走向DevOps、Cloud Native（云原生）的标准工具，而Kubernetes的编排能力，让容器能够落地到业务应用中，所以Docker、Mesos、OpenStack以及很多公有云、私有云服务商，都在支持Kubernetes，大家都加入了CNCF（云原生计算基金会）。OpenStack（也包括Vmware的虚拟化技术）是兼容传统的架构，而Kubernetes是面向未来的架构。

### 给孩子们介绍kubernetes，最萌的kubernetes的介绍
&emsp;&emsp;某一天，我的女儿溜进我的办公室，问我：“亲爱的爸爸，你的学识无可比拟，什么是kubernetes？“ 我回答道：”Kubernetes是一个开源的Docker容器编排系统，他处理计算集群的节点调度，积极的应对工作压力，保证节点的状态符合用户申明的意图，使用pod和lable的概念聚合容器，把应用组合，成为易于管理和发现的逻辑单元。“ 女儿疑惑的对我说：“what？”
&emsp;&emsp;long long ago ，有一个叫菲比的应用，他是一个简单的app应用，她由php编写并且只有一个页面，他生活在一个主机供应商那里，和哪些他不认识也不想认识的可怕应用生活在一起，他渴望拥有自己的生活环境，一个只有她和web服务的家（每个应用都有一个他依赖运行的环境，对于一个php应用来说，环境可能包含一个Web服务器，一个可读的文件系统以及一个php引擎）。某天，一个友好的鲸鱼出现在菲比面前，他建议小菲比住在容器里会比较开心，所以菲比搬家了，容器的居住环境很棒，但是新家有点像一个漂浮在汪洋大海中间的漂亮的起居室（容器提供了一个独立的让应用可以运行的环境，但是这些独立的容器通常需要被管理以及与外界通信，共享文件系统、网络调度、负载均衡、和分配都是挑战），鲸鱼把小菲比和他的容器之家带到大海后，无奈的耸耸了肩说了声对不起然后消失在海面。但在菲比开始绝望之前一位驾驶着巨轮的船长出现在海平面之上，这艘船是有许多小木筏组成的但是从外面看起来就像是一艘大船。“你好亲爱的PHP应用，我的名字是kuby船长”，智慧的船长说到。（Kubernetes是希腊语中船长领航员的意思）“我是菲比~”，小应用说到。“很高兴认识你~”，船长一边往她身上贴名牌一边说到。（kubernetes使用标签lable作为名牌来区分事物并且基于这些标签进行搜索，lable是开放式的，你可以使用他们表明角色），kuby船长建议小菲比将自己的小容器搬到船上的pod中，菲比开心的搬到了kuby的大船上，感受到加的温暖。（在kubernetes中pod是一个可以运行的最小工作单元，通常我们在pod中运行单个的容器，但如果多个容器是紧密关联的，也可以选择在同一个pod内运行多个容器）。菲比是个爱学习的小孩，他对基因和绵羊产生了浓厚的兴趣，所以他问船长：“如果我想克隆一定数量的自己呢？”船长回答道：“这太简单了！”船长把她介绍给了replication controllers（replication controllers提供了一个管理任意数量的pod的方法。rc包含了可以复制任意数量的pod模板，通过rc kubernetes可以管理pod的生命周期，包括扩缩容 滚动升级和监控）日日夜夜，菲比对他的pod和replica非常满意，但只有自己的陪伴的感觉并没有那么好，即使有多个自己的副本也不行，kuby船长慈爱的微笑着说：“我有个办法”，话音刚落，一条通道出现在了菲比和他的relication面前，这条通道可以通向其他的船舱，kuby船长大笑道：“菲比，这条通道为你和你的replication打开，你可以通过这条通道发现其他的pod，他们也可以发现你”（service会告诉其他的pod，你的应用提供的服务，及时pod的数量增增减减，service 的ip和端口依然会保持不变而且其他的服务可以通过kubernetes的服务发现找到你）。多亏了service菲比可以继续探索剩下的船舱了。不久菲比遇到了一个新朋友goldy，goldy某一天做了一建很特别的事情，他给了菲比一件礼物，菲比看见礼物就哭了，goldy问他为什么会哭呢？菲比说他太喜欢这个礼物了，但是他没有地方存放他。还好goldy知道怎么做，goldy告诉菲比它可以把礼物放到储物空间里。（存储空间是容器可以获取存放信息的地方，对于应用来说，存储空间表现为本地文件系统的一部分，但是存储空间可以存在本地存储，ceph Gluster EBS卷等）菲比非常喜欢在kuby船长的大船上生活，每一个goldy都非常的可爱，可是当他回想起在可怕的服务器供应商那里生活的时间的时候，他开始渴望拥有一点隐私。“听起来你需要的是名命空间”，kuby船长说到。（namespace的功能是提供Kubernetes的分组机制service pod reliaction controller以及存储空间可以便捷地在命名空间里协作，但同时命名空间提供了与集群其他部分的孤立），在kuby船长的大船上，菲比和他的朋友们一起杨帆远航，他不仅经历了伟大的冒险，更重要的是菲比有了一个属于自己的家，菲比从此过着幸福的生活。
&emsp;&emsp; THE END

### 撕逼大战开始了


















### 几个事实
1. 容器技术的兴起源于 PaaS 技术的普及
2. Docker 公司发布的 Docker 项目具有里程碑式的意义
3. Docker 项目通过“容器镜像”，解决了应用打包这个根本性难题
4. 容器本身没有价值，有价值的是容器编排
5. 容器技术生态才爆发了一场关于“容器编排”的“战争”。而这次战争，最终以 Kubernetes 项目和 CNCF 社区的胜利告终




