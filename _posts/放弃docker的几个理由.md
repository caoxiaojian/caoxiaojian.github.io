---
title: 灵魂七问：放弃Docker？扎心了老铁~
date: 2018-11-26 10:30:50
tags: docker
---

### 一，我不会用Docker开发。。。因为我不能编辑Dockerfile
&emsp;&emsp;作为一个开发人员，工作时需要特定的工具和环境配置。我不能编辑生产环境的Dockerfile来添加我需要的内容。生产环境的Docker镜像应该只为生产目的而配置。所以，我怎么用Docker来处理开发需求呢？如果我不能编辑Dockerfile来添加我的工具和配置，我到底该如何在Docker里开发应用程序呢？我可以复制黏贴生产环境Dockerfile到我自己的环境里，然后按照我自己的需求修改这个文件。但是，我们都知道，重复是万恶之源。并且我们都知道，重复是万恶之源。我们都知道，重复是万恶之源。（皮不皮）
&emsp;&emsp;更好的解决方案是使用Docker模式从一个生产镜像来构建自己的开发镜像，而不是复制Dockerfile。我已经从一个“node:6”的基础镜像构建了我的生产环境镜像，所以再创建一个“dev.dockerfile”并且以应用的生产环境镜像作为基础镜像来构建，现在我可以修改dev.dockerfile来适应我的开发需求，这样我还可以确切的知道我做了那修修改。

### 二，我看不到容器内的任何东西，因为我根本看不到我的容器！
&emsp;&emsp;Docker是应用的虚拟化（容器化），不是一个用于通用计算用途的完整的虚拟机，但是开发人员常常需要把一个容器当成一个虚拟机来看待。我需要获得日志（而不是应用的简单的控制台输出），检查调试输出并且确保我放入容器中的文件和系统的变化满足我所有的需求。如果容器不是虚拟机，我怎么知道是怎么回事？在容器中，我如何查看文件、环境变量和其他需要的东西？
&emsp;&emsp;如果容器已经启动并运行中，我可以使用“docker exec”命令进入容器内部，并拥有完整的shell访问权限。

### 三，我不得不在Docker容器里编码吗？但是我不能用我最喜欢的编辑器？！
&emsp;&emsp;当我第一次使用Docker容器，并且运行了Nodejs代码，我想知道在构建了镜像之后我应该如何将编辑过的代码移动到容器中。我每次都应该重新构建镜像吗？我应该shell进入容器内部用vim编辑代码吗？这个也许可以考虑的。但是，如果我想使用更好的IDE或者编辑器，这就不允许了。我不得不一直使用类似于像vim这样的编辑器（并且不是我喜欢的vim版本）。如果我只有命令行/Shell访问我的容器，我如何可以使用我喜欢的编辑器呢？
&emsp;&emsp;Docker允许我们使用“volume mount”选项从宿主机系统挂载一个文件夹到一个目标容器。借助这个选项，容器的“/var/app”文件夹将会指向本地的“/dev/my-app”目录，用我喜欢的编辑器在“/dev/my-app”目录里编辑代码，自然地就会改变容器内部可以看到及使用的代码。

### 四，我不得不每次运都行“docker run”，但是我记不住“docker run”的那些选项……
&emsp;&emsp;Docker有大量的命令行选项。查看Docker的帮助页面就像阅读一个已经灭绝的文明的古老神话巨著那样痛苦晦涩。当来到“运行”一个容器的时刻，一堆乱七八糟的options，从来没有在第一次就用正确的选项启动一个container过。而且，每一次调用“docker run”都会从镜像创建一个新的容器。如果我需要一个新的容器，这是没有问题的。然而，我只是希望运行一个我以前创建的容器，“docker run”的运行结果就让我难以接受，这是另一个新的容器实例。
&emsp;&emsp;我不需要在每一次都运行“docker run”。我可以使用“stop”和“start”控制容器。这么做也可以持久化容器在运行时的状态，我可以从容器关闭时的状态重启。如果我修改了容器内部的任何文件，那些改变可以在容器再一次启动的时候保持上一次的状态。

### 五，Docker只是命令行而我明显对于使用可视化工具更高效，且我的个人不太习惯Linux的操作系统，我更喜欢mac或windows。
&emsp;&emsp; Docker有官方的Docker for Mac和Docker for Windows软件包。Docker for Mac和Windows包含了Kitematic的基本集成，在个人PC上就有一个GUI工具可以来管理Docker镜像和容器。

### 六，我不会在容器里运行我的数据库。它不能适当地伸缩……并且我会丢失数据！
&emsp;&emsp;容器的生命周期是短暂的，他们按需被销毁和重建。但是如果我在容器里的数据库存储数据，删除容器就会删除数据。数据库这种有状态的服务在扩缩容方面也比较特殊，不同的架构类型扩容的方式也不同。单纯从扩容的角度来看，也分为横向（加机器）和纵向扩容（加大服务器资源）Docker是专注于横向扩展的，当需要更多处理能力时，可以创建更多的服务实例。而大多数数据库系统，需要特定的配置和维护来进行横向扩展。
&emsp;&emsp;使用Docker运行一个生产环境数据库并不是一个好主意。但是在测试开发环境Docker可以帮你完美的解决这个问题，一条命令run一切。现在我已经部署了mysql mongodb redis rabbitmq等。当涉及到Docker容器的宜失性属性时，就可以用挂载卷的方式来持久化我们的数据。

### 七，我不能从Docker中获益……因为Docker是“企业级的”和“DevOps”的，需要的技术储备太高了
&emsp;&emsp;docker也许更擅长DevOps，但是作为普通的开发者，我同样可以使用docker来提高我们的研发效率。docker的技术门槛并不高，相较于直接在服务器上配置redis mysql mongo rabbimq来讲，docker run可以更快的将我们需要的服务器启动起来。给自己一次机会，给Docker一个机会，从一段最小的业务代码run起，你会发现你打开了一个新世界的大门。
